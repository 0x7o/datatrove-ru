import numpy as np

from datatrove.data import Document
from datatrove.pipeline.filters.base_filter import BaseFilter
from datatrove.pipeline.writers.disk_base import DiskWriter
from datatrove.utils.text import PUNCTUATION_SET
from datatrove.utils.typeshelper import Languages
from datatrove.utils.word_tokenizers import load_word_tokenizer

STOP_WORDS = ['–æ—Ç', '–∫–æ–Ω–µ—á–Ω–æ', '–µ–π', '–º–æ–∂–Ω–æ', '–≤–∞–º', '—Ç–∞–∫', '–ø–æ—á—Ç–∏', '—Ç–µ–º', '–±—É–¥–µ—Ç', '–∏—Ö', '–Ω–µ–µ', '–º–æ—è', '–≤—Å–µ—Ö', '–Ω–µ–≥–æ',
              '—Å–æ–≤—Å–µ–º', '–≤–æ', '–¥—Ä—É–≥–æ–π', '–±—ã', '–∏–º', '–Ω–µ', '–ø—Ä–æ', '–∂–µ', '–Ω–∞', '–∏–ª–∏', '–æ–Ω–∞', '—Ä–∞–∑', '–∫—Ç–æ', '–Ω–µ—Ç', '–º–Ω–æ–≥–æ',
              '–±–æ–ª–µ–µ', '–∫—É–¥–∞', '—Ö–æ—Ç—å', '—Ç–æ–∂–µ', '—á–µ–≥–æ', '–Ω–∞—Å', '–º—ã', '—Ç–æ–≥–¥–∞', '–¥–æ', '—Ç—É—Ç', '—Ä–∞–∑–≤–µ', '–ø–µ—Ä–µ–¥', '—ç—Ç–æ–º',
              '–ª—É—á—à–µ', '–Ω–µ–ª—å–∑—è', '—Å–µ–±–µ', '–∫–∞–∫–æ–π', '—á—Ç–æ–±—ã', '–∫–∞–∫–∞—è', '–Ω–æ', '–Ω—É', '–º–µ–Ω—è', '—á—Ç–æ–±', '–∫–æ–≥–¥–∞', '—Ç—Ä–∏', '—Ç–µ–±—è',
              '–≥–¥–µ', '–Ω–∞–¥–æ', '–±–µ–∑', '—É–∂–µ', '–≤–∞—Å', '–≤–¥—Ä—É–≥', '–º–æ–∂–µ—Ç', '–±—ã–ª–∞', '–Ω–∏', '–µ—â–µ', '–ø–æ—Ç–æ–º', '–±–æ–ª—å—à–µ', '–æ–Ω',
              '–Ω–∏–∫–æ–≥–¥–∞', '–¥–ª—è', '–º–æ–π', '–º–Ω–µ', '—á–µ—Ä–µ–∑', '–≤–æ—Ç', '–±—ã–ª', '–≤–µ–¥—å', '–ø–æ—Å–ª–µ', '–Ω–µ–π', '–µ—Å–ª–∏', '–±—ã–ª–∏', '–æ–ø—è—Ç—å',
              '–ª–∏', '–æ–±', '—Å–µ–π—á–∞—Å', '—ç—Ç–æ–≥–æ', '—Å–∞–º', '—Å–≤–æ—é', '—Å–æ', '–∏–Ω–æ–≥–¥–∞', '—Ç–æ–ª—å–∫–æ', '—á–µ–º', '–µ–º—É', '–≤–ø—Ä–æ—á–µ–º', '–≤—Å—é',
              '–ø–æ—Ç–æ–º—É', '–æ–¥–∏–Ω', '–∏–∑', '—É–∂', '–æ–Ω–∏', '–Ω–∏–±—É–¥—å', '–¥–∞', '–Ω–∏—Ö', '—á—É—Ç—å', '–±—É–¥—Ç–æ', '—Å–µ–±—è', '–±—ã—Ç—å', '–º–µ–∂–¥—É',
              '–µ–≥–æ', '—ç—Ç—É', '—Ö–æ—Ä–æ—à–æ', '–µ—Å—Ç—å', '—ç—Ç–∏', '—ç—Ç–æ—Ç', '–ø—Ä–∏', '–≤—Å–µ', '–¥–∞–∂–µ', '—Ç–æ–≥–æ', '–ø–æ', '–Ω–∏–º', '–∫–∞–∫', '–∑–∞—á–µ–º',
              '–¥–≤–∞', '—Ç–∞–∫–æ–π', '—Ç–µ–ø–µ—Ä—å', '—Ç–∞–º', '–Ω–∞–¥', '–≤—ã', '–∑–¥–µ—Å—å', '—Ç–æ—Ç', '–≤—Å–µ–≥–¥–∞', '—Ç—ã', '–Ω–∞–∫–æ–Ω–µ—Ü', '—ç—Ç–æ–π', '–µ–µ',
              '—á—Ç–æ', '–Ω–∏—á–µ–≥–æ', '–≤—Å–µ–≥–æ', '—Ç–æ–º', '–ø–æ–¥', '–∑–∞', '—Ç–æ', '–±—ã–ª–æ']


class GopherQualityFilter(BaseFilter):
    name = "ü•á Gopher Quality"

    def __init__(
            self,
            min_doc_words: int | None = 50,
            max_doc_words: int | None = 100000,
            min_avg_word_length: int | None = 3,
            max_avg_word_length: int | None = 10,
            max_symbol_word_ratio: float | None = 0.1,
            max_bullet_lines_ratio: float | None = 0.9,
            max_ellipsis_lines_ratio: float | None = 0.3,
            max_non_alpha_words_ratio: float | None = 0.8,
            min_stop_words: int | None = 2,
            stop_words: list[str] | None = None,
            exclusion_writer: DiskWriter = None,
            language: str = Languages.english,
    ):
        """
        Filter to apply Gopher's quality heuristic rules.
        Reference: https://arxiv.org/pdf/2112.11446.pdf

        Args:
            min_doc_words:
            max_doc_words:
            min_avg_word_length:
            max_avg_word_length:
            max_symbol_word_ratio:
            max_bullet_lines_ratio:
            max_ellipsis_lines_ratio:
            max_non_alpha_words_ratio:
            min_stop_words:
            stop_words:
            exclusion_writer:
        """
        super().__init__(exclusion_writer)
        self.min_doc_words = min_doc_words
        self.max_doc_words = max_doc_words
        self.min_avg_word_length = min_avg_word_length
        self.max_avg_word_length = max_avg_word_length
        self.max_symbol_word_ratio = max_symbol_word_ratio
        self.max_bullet_lines_ratio = max_bullet_lines_ratio
        self.max_ellipsis_lines_ratio = max_ellipsis_lines_ratio
        self.max_non_alpha_words_ratio = max_non_alpha_words_ratio
        self.min_stop_words = min_stop_words
        self.stop_words = set(STOP_WORDS if stop_words is None else stop_words)
        self.tokenizer = load_word_tokenizer(language)

    def filter(self, doc: Document) -> bool | tuple[bool, str]:
        """

        Args:
            doc: Applies the heuristics rules to decide if a document should be REMOVED


        Returns: False if sample.text does not pass any of the the heuristic tests

        """
        text = doc.text
        words = self.tokenizer.word_tokenize(text)
        n_words = len(words)

        non_symbol_words = [w for w in words if any(ch not in PUNCTUATION_SET for ch in w)]
        n_non_symbol_words_words = len(non_symbol_words)

        # words < min_doc_words or words > max_doc_words
        if self.min_doc_words and n_non_symbol_words_words < self.min_doc_words:
            return False, "gopher_short_doc"
        if self.max_doc_words and n_non_symbol_words_words > self.max_doc_words:
            return False, "gopher_long_doc"

        # mean word length is outside the range of 3 to 10 characters
        avg_n_words = np.mean([len(w) for w in non_symbol_words])
        if self.min_avg_word_length and avg_n_words < self.min_avg_word_length:
            return False, "gopher_below_avg_threshold"
        if self.max_avg_word_length and avg_n_words > self.max_avg_word_length:
            return False, "gopher_above_avg_threshold"

        # symbol-to-word ratio greater than 0.1 for either the hash symbol or the ellipsis
        if self.max_symbol_word_ratio and text.count("#") / n_words > self.max_symbol_word_ratio:
            return False, "gopher_too_many_hashes"
        if self.max_symbol_word_ratio and (text.count("...") + text.count("‚Ä¶")) / n_words > self.max_symbol_word_ratio:
            return False, "gopher_too_many_ellipsis"

        # any document with more than 90 % of lines starting with a bullet point,
        # or more than 30 % ending with an ellipsis.
        lines = text.splitlines()
        if (
                self.max_bullet_lines_ratio
                and sum(s.lstrip().startswith("‚Ä¢") or s.lstrip().startswith("-") for s in lines) / len(lines)
                > self.max_bullet_lines_ratio
        ):
            return False, "gopher_too_many_bullets"
        if (
                self.max_ellipsis_lines_ratio
                and sum(s.rstrip().endswith("...") or s.rstrip().endswith("‚Ä¶") for s in lines) / len(lines)
                > self.max_ellipsis_lines_ratio
        ):
            return False, "gopher_too_many_end_ellipsis"

        # that 80 % of words in a document contain at least one alphabetic character
        if (
                self.max_non_alpha_words_ratio
                and sum([any((c.isalpha() for c in w)) for w in words]) / n_words < self.max_non_alpha_words_ratio
        ):
            return False, "gopher_below_alpha_threshold"

        # stop word filter
        if self.min_stop_words and sum(w in self.stop_words for w in words) < self.min_stop_words:
            return False, "gopher_enough_stop_words"

        return True


if __name__ == "__main__":
    filter = GopherQualityFilter(
        language=Languages.russian,
    )
    doc = Document(
        id="test",
        text="""–£–±–æ—Ä–∫–∞ –≤ –∞—Ä–º–∏–∏ - –°—Ç—Ä–∞–Ω–∏—Ü–∞ 3 - –§–æ—Ä—É–º - –ú–∞—Ç—å —Å–æ–ª–¥–∞—Ç–∞ –†–∞–¥–∞33 –ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫, 19.03.2018, 17:11 | –°–æ–æ–±—â–µ–Ω–∏–µ ‚Ññ 31 | –¶–∏—Ç–∞—Ç–∞ | –û—Ç–≤–µ—Ç–∏—Ç—å –î–∞ –∏—Ö –Ω–∏–≥–¥–µ —É–∂ –Ω–µ—Ç—É, —Ç—é-—Ç—é! –°–∞–º–∏ —Å–æ–ª–¥–∞—Ç–∏–∫–∏ –ø–æ–ª –¥—Ä–∞—é—Ç. –ü—Ä–∏—á–µ–º, –≤—Ç–∏—Ä–∞—é—Ç –Ω–∞–º, –º–æ–ª –∏–º —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –ø—ã–ª–µ—Å–æ—Å—ã –∑–∞–∫—É–ø–∏–ª–∏... –ù–µ –∑–Ω–∞—é, –≤ –Ω–∞—à–µ–π –≤—Å–µ —Ä—É—á–∫–∞–º–∏, –∫—É—á—É –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞ –µ—Ä—É–Ω–¥—É —ç—Ç—É —Ç—Ä–∞—Ç—è—Ç! –ê –∑–∏–º–æ–π —Å–Ω–µ–≥ —Ä–∞–∑–≥—Ä–µ–±–∞—Ç—å —Å –ª–æ–ø–∞—Ç–∞–º–∏ –ø–æ—Å—ã–ª–∞–ª–∏ - –∞ –∫–æ–º–º—É–Ω–∞–ª—å—â–∏–∫–∏ –∑–∞ —á—Ç–æ –¥–µ–Ω—é–∂–∫–∏ —Å–≤–æ–∏ –ø–æ–ª—É—á–∞—é—Ç??? –ß—Ç–æ–± —Å–≤–æ—é —Ä–∞–±–æ—Ç—É –Ω–∞ –∫—Ä–∞–π–Ω–µ–≥–æ –ø–µ—Ä–µ–ª–æ–∂–∏—Ç—å, –≤–æ—Ç-–≤–æ—Ç! –ú–∞—Ä–∏–Ω–∞_70 –°—Ä–µ–¥–∞, 21.03.2018, 10:18 | –°–æ–æ–±—â–µ–Ω–∏–µ ‚Ññ 32 | –¶–∏—Ç–∞—Ç–∞ | –û—Ç–≤–µ—Ç–∏—Ç—å –Ø –≤–æ—Ç —Ç–æ–∂–µ –Ω–µ –ø–æ–Ω–∏–º–∞—é —á—Ç–æ —ç—Ç–æ –∑–∞ —Å–ª—É–∂–±–∞ —Ç–∞–∫–∞—è? –í–µ–¥—å –Ω–µ —É–±–æ—Ä–∫–µ —É—á–∏—Ç—å—Å—è –∏–¥—É—Ç —Ä–µ–±—è—Ç–∞ –≤ –∞—Ä–º–∏—é, –∞ —Å–ª—É–∂–∏—Ç—å —Å—Ç—Ä–∞–Ω–µ. –ï–ª–µ–Ω–∞–ü—Ä–µ–º—É–¥—Ä–∞—è –ü—è—Ç–Ω–∏—Ü–∞, 06.04.2018, 15:52 | –°–æ–æ–±—â–µ–Ω–∏–µ ‚Ññ 33 | –¶–∏—Ç–∞—Ç–∞ | –û—Ç–≤–µ—Ç–∏—Ç—å –ü–æ–∫–∞ –≤—Å—ë –≥–æ–≤–æ—Ä–∏—Ç, –ø—Ä–æ—Å—Ç–æ –∫—Ä–∏—á–∏—Ç –æ–± –æ–±—Ä–∞—Ç–Ω–æ–º. –ü–æ—Ö–æ–∂–µ, –Ω–∞—à–∏ –º–∞–ª—å—á–∏—à–∫–∏ –±—ã–ª–∏ –ø—Ä–∏–∑–≤–∞–Ω—ã –≤ –≤–æ–π—Å–∫–∞ —É–±–æ—Ä—â–∏–∫–æ–≤. –ò –∑–∞—â–∏—â–∞—Ç—å —Å—Ç—Ä–∞–Ω—É –∏—Ö —É—á–∞—Ç —Å –ø–æ–º–æ—â—å—é —Å–æ–≤–∫–æ–≤ –∏ –º–µ—Ç—ë–ª–æ–∫! –£–≤—ã. masha233 –ß–µ—Ç–≤–µ—Ä–≥, 12.04.2018, 11:15 | –°–æ–æ–±—â–µ–Ω–∏–µ ‚Ññ 34 | –¶–∏—Ç–∞—Ç–∞ | –û—Ç–≤–µ—Ç–∏—Ç—å –º–æ–π —Å—ã–Ω —Ä–∞—Å—Å–∫–∞–∑—ã–≤–∞–ª, –∫–∞–∫ –∑–∏–º–æ–π —Å–Ω–µ–≥ –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –∑–∞—Å—Ç–∞–≤–ª—è–ª–∏ —á–∏—Å—Ç–∏—Ç—å, –ø–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ —á–∞—Å–æ–≤ –Ω–∞ –º–æ—Ä–æ–∑–µ. –≤–æ—Ç —Å–ª—É–∂–±–∞-—Ç–æ –æ—Ç–ª–∏—á–Ω–∞—è...–Ω–∞—à–ª–∏ —Ä–∞–±–æ—á—É—é —Å–∏–ª—É. –º–Ω–µ –∫–∞–∂–µ—Ç—Å—è, –∫–∞–∂–¥—ã–π –¥–æ–ª–∂–µ–Ω –∑–∞–Ω–∏–º–∞—Ç—å—Å—è —Å–≤–æ–∏–º –¥–µ–ª–æ–º. –∞ —É –Ω–∞—Å –∫–∞–∫ –≤—Å–µ–≥–¥–∞... IrinaVas –ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫, 23.04.2018, 11:58 | –°–æ–æ–±—â–µ–Ω–∏–µ ‚Ññ 35 | –¶–∏—Ç–∞—Ç–∞ | –û—Ç–≤–µ—Ç–∏—Ç—å –ò –Ω–µ –≥–æ–≤–æ—Ä–∏—Ç–µ...–∑–∏–º–æ–π –±—ã–ª —Å–Ω–µ–≥, —Ç–∞–∫ –æ–Ω–∏ –µ–≥–æ –∏ —Ä–∞—Å—á–∏—â–∞–ª–∏. –ê —Ç–µ–ø–µ—Ä—å –≤—Å–µ —Ç–∞–µ—Ç –∏ –æ–Ω–∏ –æ–¥–Ω–æ–π —Ä—É–∫–æ–π –≤—ã—á–µ—Ä–ø—ã–≤–∞—é—Ç —Ç–∞–ª—É—é –≤–æ–¥—É , –∞ –¥—Ä—É–≥–æ–π —É–±–∏—Ä–∞—é—Ç –ø—Ä–æ—à–ª–æ–≥–æ–¥–Ω–∏–π –º—É—Å–æ—Ä, –∫–æ—Ç–æ—Ä—ã–π –≤—ã–ª–µ–∑ –∏–∑ –ø–æ–¥ —Å–Ω–µ–≥–∞ –∫–∞–∫ –ø–æ–¥—Å–Ω–µ–∂–Ω–∏–∫–∏...–∞ –≥–¥–µ –∫–æ–º–º—É–Ω–∞–ª—å–Ω—ã–µ —Å–ª—É–∂–±—ã –≥–æ—Ä–æ–¥–æ–≤? –ø–æ—á–µ–º—É –ø—Ä–∏–≤–ª–µ–∫–∞—é—Ç —Å–æ–ª–¥–∞—Ç–æ–≤ –Ω–µ —è—Å–Ω–æ... Andry –ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫, 07.05.2018, 10:02 | –°–æ–æ–±—â–µ–Ω–∏–µ ‚Ññ 36 | –¶–∏—Ç–∞—Ç–∞ | –û—Ç–≤–µ—Ç–∏—Ç—å –¶–∏—Ç–∞—Ç–∞ –ï–ª–µ–Ω–∞–ü—Ä–µ–º—É–¥—Ä–∞—è ( ) –ü–æ—Ö–æ–∂–µ, –Ω–∞—à–∏ –º–∞–ª—å—á–∏—à–∫–∏ –±—ã–ª–∏ –ø—Ä–∏–∑–≤–∞–Ω—ã –≤ –≤–æ–π—Å–∫–∞ —É–±–æ—Ä—â–∏–∫–æ–≤. –ò –∑–∞—â–∏—â–∞—Ç—å —Å—Ç—Ä–∞–Ω—É –∏—Ö —É—á–∞—Ç —Å –ø–æ–º–æ—â—å—é —Å–æ–≤–∫–æ–≤ –∏ –º–µ—Ç—ë–ª–æ–∫! –£–≤—ã. –ö —Å–æ–∂–∞–ª–µ–Ω–∏—é —Ç–∞–∫ –∏ –µ—Å—Ç—å! –í–æ—Ç —Ç–æ–ª—å–∫–æ –ø–æ–ª—ã –±—ã –æ–Ω–∏ –∏ –Ω–∞ –≥—Ä–∞–∂–¥–∞–Ω–∫–µ –º–æ–≥–ª–∏ –±—ã –¥—Ä–∞–∏—Ç—å... masha233 –ß–µ—Ç–≤–µ—Ä–≥, 10.05.2018, 11:05 | –°–æ–æ–±—â–µ–Ω–∏–µ ‚Ññ 37 | –¶–∏—Ç–∞—Ç–∞ | –û—Ç–≤–µ—Ç–∏—Ç—å –æ–±—Å—É–∂–¥–∞—Ç—å –∏ —Ä—É–≥–∞—Ç—å—Å—è - —ç—Ç–æ –≤—Å–µ —Ö–æ—Ä–æ—à–æ. –≤–æ—Ç —Ç–æ–ª—å–∫–æ —ç—Ç–æ –Ω–µ –¥–∞—Å—Ç –Ω–∏—á–µ–≥–æ, –Ω–∞–¥–æ –¥–µ–ª–∞—Ç—å —á—Ç–æ-—Ç–æ –¥–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –∏—Å–ø—Ä–∞–≤–∏—Ç—å —Å–∏—Ç—É–∞—Ü–∏—é. —è –Ω–∞–ø–∏—Å–∞–ª–∞ –≤ –æ–±—â–µ—Å—Ç–≤–µ–Ω–Ω—É—é –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—é, –∂–¥—É –æ—Ç–≤–µ—Ç–∞ Andry –ü—è—Ç–Ω–∏—Ü–∞, 18.05.2018, 15:55 | –°–æ–æ–±—â–µ–Ω–∏–µ ‚Ññ 38 | –¶–∏—Ç–∞—Ç–∞ | –û—Ç–≤–µ—Ç–∏—Ç—å –ê–Ω–∞–ª–æ–≥–∏—á–Ω–∞—è —Å–∏—Ç—É–∞—Ü–∏—è. –ï–∂–µ–¥–Ω–µ–≤–Ω–æ —Å–æ —à–≤–∞–±—Ä–æ–π –∏ –º–µ—Ç–ª–æ–π –≤ —Ä—É–∫–∞—Ö. –°–∫–ª–∞–¥—ã–≤–∞–µ—Ç—Å—è —Ç–∞–∫–æ–µ –≤–ø–µ—á–∞—Ç–ª–µ–Ω–∏–µ, —á—Ç–æ –∞–≤—Ç–æ–º–∞—Ç —Ç–µ–ø–µ—Ä—å –≤ –∞—Ä–º–∏–∏ –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω. –Ø, –∫–æ–Ω–µ—á–Ω–æ, –ø–æ–º–Ω—é –ü–•–î —Ä–∞–Ω—å—à–µ, –Ω–æ –∏ –±–æ–µ–≤–∞—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –ø—Ä–∏ —ç—Ç–æ–º –±—ã–ª–∞ –Ω–æ—Ä–º–∞–ª—å–Ω–∞—è. –ê —Å–µ–π—á–∞—Å –ø—Ä–∏—Ö–æ–¥—è—Ç –æ—Ç—Ç—É–¥–∞ –∏ –≥–æ–≤–æ—Ä—è—Ç, —á—Ç–æ –æ—Ä—É–∂–∏–µ –≤ —Ä—É–∫–∞—Ö –¥–µ—Ä–∂–∞–ª–∏ –≤—Å–µ–≥–æ –ø–∞—Ä—É —Ä–∞–∑. –ó–∞—Ç–æ –º–µ—Ç–ª—É - –∫–∞–∂–¥—ã–π –¥–µ–Ω—å. –≠—Ç–æ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ. GhostPetor –í—Ç–æ—Ä–Ω–∏–∫, 22.05.2018, 10:53 | –°–æ–æ–±—â–µ–Ω–∏–µ ‚Ññ 39 | –¶–∏—Ç–∞—Ç–∞ | –û—Ç–≤–µ—Ç–∏—Ç—å –ü—Ä–∞–≤–∏–ª—å–Ω–æ –≤—ã—à–µ –Ω–∞–ø–∏—Å–∞–ª–∏, —á—Ç–æ –Ω—É–∂–Ω–æ –æ–±—Ä–∞—â–∞—Ç—å—Å—è –≤ –∫–æ–º–ø–µ—Ç–µ–Ω—Ç–Ω—ã–µ –∏–Ω—Å—Ç–∞–Ω—Ü–∏–∏. –ü—Ä–æ—Å—Ç–æ –∂–∞–ª–æ–±–∞–º–∏ –∑–¥–µ—Å—å –º—ã –≤—Ä—è–¥ –ª–∏ —á—Ç–æ-—Ç–æ –∏–∑–º–µ–Ω–∏–º. –ò, —è —Ç–∞–∫ –ø–æ–Ω–∏–º–∞—é, —á—Ç–æ —Ç–∞–∫–∞—è —Å–∏—Ç—É–∞—Ü–∏—è —Å–µ–π—á–∞—Å –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –≤–µ–∑–¥–µ. –ö–æ–º–∏—Ç–µ—Ç—ã —Å–æ–ª–¥–∞—Ç—Å–∫–∏—Ö –º–∞—Ç–µ—Ä–µ–π —Ç—É—Ç –±–µ—Å—Å–∏–ª—å–Ω—ã? IrinaVas –ü—è—Ç–Ω–∏—Ü–∞, 01.06.2018, 11:59 | –°–æ–æ–±—â–µ–Ω–∏–µ ‚Ññ 40 | –¶–∏—Ç–∞—Ç–∞ | –û—Ç–≤–µ—Ç–∏—Ç—å –ê —Å–µ–π—á–∞—Å –ø—Ä–∏—Ö–æ–¥—è—Ç –æ—Ç—Ç—É–¥–∞ –∏ –≥–æ–≤–æ—Ä—è—Ç, —á—Ç–æ –æ—Ä—É–∂–∏–µ –≤ —Ä—É–∫–∞—Ö –¥–µ—Ä–∂–∞–ª–∏ –≤—Å–µ–≥–æ –ø–∞—Ä—É —Ä–∞–∑. –ó–∞—Ç–æ –º–µ—Ç–ª—É - –∫–∞–∂–¥—ã–π –¥–µ–Ω—å. –≠—Ç–æ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ. –ü–æ–ª–Ω–æ—Å—Ç—å—é –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é! –ê—Ä–º–∏—è –¥–ª—è —Ç–æ–≥–æ –∏ –∞—Ä–º–∏—è, —á—Ç–æ–±—ã –Ω–∞—É—á–∏—Ç—å—Å—è –∑–∞—â–∏—â–∞—Ç—å —Å—Ç—Ä–∞–Ω—É –∏ —Å–µ–º—å—é! –ê –Ω–µ —Å –º–µ—Ç–ª–æ–π –∏ —Ç—Ä—è–ø–∫–∞–º–∏ –±–µ–≥–∞—Ç—å Andry –í—Ç–æ—Ä–Ω–∏–∫, 05.06.2018, 10:35 | –°–æ–æ–±—â–µ–Ω–∏–µ ‚Ññ 41 | –¶–∏—Ç–∞—Ç–∞ | –û—Ç–≤–µ—Ç–∏—Ç—å –¶–∏—Ç–∞—Ç–∞ IrinaVas ( ) –ê—Ä–º–∏—è –¥–ª—è —Ç–æ–≥–æ –∏ –∞—Ä–º–∏—è, —á—Ç–æ–±—ã –Ω–∞—É—á–∏—Ç—å—Å—è –∑–∞—â–∏—â–∞—Ç—å —Å—Ç—Ä–∞–Ω—É –∏ —Å–µ–º—å—é! –ê –Ω–µ —Å –º–µ—Ç–ª–æ–π –∏ —Ç—Ä—è–ø–∫–∞–º–∏ –±–µ–≥–∞—Ç—å –ü–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ–≥–ª–∞—à—É—Å—å. –†–µ–∞–ª—å–Ω–æ —Å —Ç—Ä—è–ø–∫–æ–π –∏ –º–µ—Ç–ª–æ–π –º–æ–∂–Ω–æ –Ω–∞ –≥—Ä–∞–∂–¥–∞–Ω–∫–µ —É–ø—Ä–∞–∂–Ω—è—Ç—å—Å—è, –µ—Å–ª–∏ –µ—Å—Ç—å –∂–µ–ª–∞–Ω–∏–µ. –ê –≤ –∞—Ä–º–∏—é –Ω—É–∂–Ω–æ –∏–¥—Ç–∏ —Å–ª—É–∂–∏—Ç—å, –∑–∞–Ω–∏–º–∞—Ç—å—Å—è —Ñ–∏–∑–∏—á–µ—Å–∫–æ–π –ø–æ–¥–≥–æ—Ç–æ–≤–∫–æ–π, –æ—Å–≤–∞–∏–≤–∞—Ç—å –æ—Ä—É–∂–∏–µ... –ü–∞–ø–∞—à–∞ –°—Ä–µ–¥–∞, 06.06.2018, 19:47 | –°–æ–æ–±—â–µ–Ω–∏–µ ‚Ññ 42 | –¶–∏—Ç–∞—Ç–∞ | –û—Ç–≤–µ—Ç–∏—Ç—å –¶–∏—Ç–∞—Ç–∞ GhostPetor ( ) –î–∞. –¢–∞–∫–∞—è —Å–∏—Ç—É–∞—Ü–∏—è —Å–µ–π—á–∞—Å –≤–µ–∑–¥–µ. –õ–µ—Ç 5-7 –Ω–∞–∑–∞–¥, –≤ –≤–æ–∏–Ω—Å–∫–∏—Ö —á–∞—Å—Ç—è—Ö (–Ω–µ –≤–æ –≤—Å–µ—Ö) –±—ã–ª–∏ –≥—Ä–∞–∂–¥–∞–Ω—Å–∫–∏–µ —É–±–æ—Ä—â–∏–∫–∏. –ù–æ –ø–æ—Å–ª–µ –∫—Ä–∏–∑–∏—Å–∞ 2014 –≥–æ–¥–∞, –≥—Ä–∞–∂–¥–∞–Ω—Å–∫–∏–µ —É–±–æ—Ä—â–∏–∫–∏, –Ω–µ–∑–∞–º–µ—Ç–Ω–æ –∏—Å—á–µ–∑–ª–∏ –∏–∑ –≤–æ–∏–Ω—Å–∫–∏—Ö —á–∞—Å—Ç–µ–π. –ï–ª–µ–Ω–∞–ü—Ä–µ–º—É–¥—Ä–∞—è –ü—è—Ç–Ω–∏—Ü–∞, 20.07.2018, 09:20 | –°–æ–æ–±—â–µ–Ω–∏–µ ‚Ññ 43 | –¶–∏—Ç–∞—Ç–∞ | –û—Ç–≤–µ—Ç–∏—Ç—å –°—Ç–æ–ª—å–∫–æ —á–∏—Ç–∞—é –æ —Ç–æ–º. –ö–∞–∫ –≤ –∞—Ä–º–∏–∏ –≤—Å—ë –º–µ–Ω—è–µ—Ç—Å—è –∫ –ª—É—á—à–µ–º—É, –æ—Å–æ–±–µ–Ω–Ω–æ –±—ã—Ç–æ–≤—ã–µ —É—Å–ª–æ–≤–∏—è, –¥—É—à–µ–≤—ã–µ —Ç–∞–º, –∑–≤–æ–Ω–∏—Ç—å –≤–æ—Ç —Ç–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ, –ø–∏—Ç–∞–Ω–∏–µ –≤–∫—É—Å–Ω–æ–µ, –Ω–æ –Ω–µ—É–∂–µ–ª–∏ –Ω–µ–ª—å–∑—è —Å–¥–µ–ª–∞—Ç—å –∏ —Å —É–±–æ—Ä–∫–æ–π —á—Ç–æ-—Ç–æ? –≠—Ç–æ –∂–µ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ, —Å—ã–Ω –∫–∞–∫ –Ω–µ –ø–æ–∑–≤–æ–Ω–∏—Ç, –≤—Å–µ–≥–¥–∞ ¬´—è –Ω–µ–Ω–∞–¥–æ–ª–≥–æ, –º–∞–º¬ª, —Ç.–∫. –æ–Ω –∏–ª–∏ —Ç–æ–ª—å–∫–æ —Å —É–±–æ—Ä–∫–∏, –∏–ª–∏ –±–µ–∂–∏—Ç –Ω–∞ —É–±–æ—Ä–∫—É. –ú–æ–∑–æ–ª–∏ –≥–æ–≤–æ—Ä–∏—Ç –Ω–µ –ø—Ä–æ—Ö–æ–¥—è—Ç –Ω–∞ —Ä—É–∫–∞—Ö, —Ç–æ –º—ë—Ç–ª–∞–º–∏ –º–∞—à—É—Ç, —Ç–æ –ª–æ–ø–∞—Ç–∞–º–∏ ‚Ä¶ –ß–µ–º—É –æ–Ω–∏ —Ç–∞–∫ –Ω–∞—É—á–∞—Ç—Å—è –≤ —ç—Ç–æ–π –∞—Ä–º–∏–∏?? IrinaVas –í—Ç–æ—Ä–Ω–∏–∫, 24.07.2018, 09:49 | –°–æ–æ–±—â–µ–Ω–∏–µ ‚Ññ 44 | –¶–∏—Ç–∞—Ç–∞ | –û—Ç–≤–µ—Ç–∏—Ç—å –ö–æ–º–∏—Ç–µ—Ç—ã —Å—Ç–∞—Ä–∞—é—Ç—Å—è –≤—Ä–æ–¥–µ —á—Ç–æ-—Ç–æ —Å–¥–µ–ª–∞—Ç—å, –Ω–æ –Ω–µ–∫–æ—Ç–æ—Ä—ã–º –º–∞–º–∞–º –ø—É—Å—Ç—å –ª—É—á—à–µ —Å—ã–Ω–æ–∫ –º–∞—à–µ—Ç —Ç—Ä—è–ø–∫–æ–π, —á–µ–π –æ—Ä—É–∂–∏–µ –≤ —Ä—É–∫–∏ –±–µ—Ä–µ—Ç - –Ω–µ –¥–∞–π –±–æ–≥ —á—Ç–æ. –ü–æ –º–Ω–µ —Ç–∞–∫ –º—É–∂–∏–∫ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –º—É–∂–∏–∫–æ–º, –∏ –Ω–µ –±–æ—è—Ç—å—Å—è —Ç–∞–∫–∏—Ö –≤–µ—â–µ–π...–≤—Å—é –∂–∏–∑–Ω—å –¥–µ—Ä–∂–∞—Å—å –∑–∞ –º–∞—Ç–µ—Ä–∏–Ω—Å–∫–∏–π –ø–æ–¥–æ–ª –∂–∏—Ç—å –Ω–µ –ø–æ–ª—É—á–∏—Ç—Å—è ElenaSviridova –í—Ç–æ—Ä–Ω–∏–∫, 04.09.2018, 10:35 | –°–æ–æ–±—â–µ–Ω–∏–µ ‚Ññ 45 | –¶–∏—Ç–∞—Ç–∞ | –û—Ç–≤–µ—Ç–∏—Ç—å –£–±–æ—Ä–∫–∞ —É–±–æ—Ä–∫–æ–π, –Ω–æ –Ω–µ –±–æ–ª—å—à—É—é —á–∞—Å—Ç—å –≤—Ä–µ–º–µ–Ω–∏ –∂–µ? –°—ã–Ω –≤—Ä–æ–¥–µ –≤ —Ç–∞–Ω–∫–æ–≤—ã—Ö, –∞ –ø–æ —Å—É—Ç–∏ - —Ç—Ä—è–ø–∫–æ-–≤–µ–¥–µ—Ä–Ω—ã—Ö –≤–æ–π—Å–∫–∞—Ö. –î–æ–±–∞–≤–ª–µ–Ω–æ (11.10.2018, 12:19) –°—Ç–æ–ª—å–∫–æ —á–∏—Ç–∞—é –æ —Ç–æ–º. –ö–∞–∫ –≤ –∞—Ä–º–∏–∏ –≤—Å—ë –º–µ–Ω—è–µ—Ç—Å—è –∫ –ª—É—á—à–µ–º—É, –æ—Å–æ–±–µ–Ω–Ω–æ –±—ã—Ç–æ–≤—ã–µ —É—Å–ª–æ–≤–∏—è, –¥—É—à–µ–≤—ã–µ —Ç–∞–º, –∑–≤–æ–Ω–∏—Ç—å –≤–æ—Ç —Ç–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ, –ø–∏—Ç–∞–Ω–∏–µ –≤–∫—É—Å–Ω–æ–µ, –Ω–æ –Ω–µ—É–∂–µ–ª–∏ –Ω–µ–ª—å–∑—è —Å–¥–µ–ª–∞—Ç—å –∏ —Å —É–±–æ—Ä–∫–æ–π —á—Ç–æ-—Ç–æ? –≠—Ç–æ –∂–µ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ, —Å—ã–Ω –∫–∞–∫ –Ω–µ –ø–æ–∑–≤–æ–Ω–∏—Ç, –≤—Å–µ–≥–¥–∞ ¬´—è –Ω–µ–Ω–∞–¥–æ–ª–≥–æ, –º–∞–º¬ª, —Ç.–∫. –æ–Ω –∏–ª–∏ —Ç–æ–ª—å–∫–æ —Å —É–±–æ—Ä–∫–∏, –∏–ª–∏ –±–µ–∂–∏—Ç –Ω–∞ —É–±–æ—Ä–∫—É. –ú–æ–∑–æ–ª–∏ –≥–æ–≤–æ—Ä–∏—Ç –Ω–µ –ø—Ä–æ—Ö–æ–¥—è—Ç –Ω–∞ —Ä—É–∫–∞—Ö, —Ç–æ –º—ë—Ç–ª–∞–º–∏ –º–∞—à—É—Ç, —Ç–æ –ª–æ–ø–∞—Ç–∞–º–∏ ‚Ä¶ –ß–µ–º—É –æ–Ω–∏ —Ç–∞–∫ –Ω–∞—É—á–∞—Ç—Å—è –≤ —ç—Ç–æ–π –∞—Ä–º–∏–∏?? >( –ù–µ –≤—Å–µ –∫–æ—Ç—É –ú–∞—Å–ª–µ–Ω–∏—Ü–∞...—É–±–æ—Ä–∫–∞ —É–±–æ—Ä–∫–æ–π, –Ω–æ –≤—Å–µ-—Ç–∞–∫–∏ —Å—ã–Ω –º–µ—á—Ç–∞–ª –ø–æ—Ç–æ–º –ø–æ–π—Ç–∏ –ø–æ –≤–æ–µ–Ω–Ω–æ–π —Å—Ç–µ–∑–µ. –ê —Å —Ç–∞–∫–∏–º–∏ –Ω–∞–≤—ã–∫–∞–º–∏ –¥–∞–ª–µ–∫–æ –Ω–µ —É–π–¥–µ—à—å, –∫–æ–Ω–µ—á–Ω–æ"""
    )
    print(filter.filter(doc))
